---
Date: 2025-08-27 18:12:58
LastEditTime: 2025-08-28 09:42:03
description: 完整介绍 WFN 文件结构、字段含义及与 MolStar 的对接要点，含示例与注意事项。
head:
  - - meta
    - name: keywords
      content: MolStar, wfn, AIMPAC, Multiwfn, 高斯基组, 波函数文件格式
tags:
  - MolStar
  - wfn
---

# WFN

> wfn 文件最早作为Bader的AIMPAC程序的输入文件出现，AIMPAC是历史最久的AIM分析软件，后来其它的AIM分析软件如 [Multiwfn](http://sobereva.com/multiwfn)、AIM2000、AIMALL、Morphy、Xaim等等也都需要wfn文件。

```txt [demo.wfn]
Title Card Required
GAUSSIAN              5 MOL ORBITALS     27 PRIMITIVES        5 NUCLEI
  C    1    (CENTRE  1)   0.00000000  0.00000000  0.00000000  CHARGE =  6.0
  H    2    (CENTRE  2)   1.16740622  1.16740622  1.16740622  CHARGE =  1.0
  H    3    (CENTRE  3)  -1.16740622 -1.16740622  1.16740622  CHARGE =  1.0
  H    4    (CENTRE  4)  -1.16740622  1.16740622 -1.16740622  CHARGE =  1.0
  H    5    (CENTRE  5)   1.16740622 -1.16740622 -1.16740622  CHARGE =  1.0
CENTRE ASSIGNMENTS    1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  2  2  2  3  3
CENTRE ASSIGNMENTS    3  4  4  4  5  5  5
TYPE ASSIGNMENTS      1  1  1  1  1  2  2  3  3  4  4  1  2  3  4  1  1  1  1  1
TYPE ASSIGNMENTS      1  1  1  1  1  1  1
EXPONENTS  0.1722560D+03 0.2591090D+02 0.5533350D+01 0.3664980D+01 0.7705450D+00
EXPONENTS  0.3664980D+01 0.7705450D+00 0.3664980D+01 0.7705450D+00 0.3664980D+01
EXPONENTS  0.7705450D+00 0.1958570D+00 0.1958570D+00 0.1958570D+00 0.1958570D+00
EXPONENTS  0.5447178D+01 0.8245472D+00 0.1831916D+00 0.5447178D+01 0.8245472D+00
EXPONENTS  0.1831916D+00 0.5447178D+01 0.8245472D+00 0.1831916D+00 0.5447178D+01
EXPONENTS  0.8245472D+00 0.1831916D+00
......
MO    3     MO 0.0        OCC NO =    2.0000000  ORB. ENERGY =   -0.548298
  0.00000000D+00  0.00000000D+00  0.00000000D+00  0.00000000D+00  0.00000000D+00
  0.00000000D+00  0.00000000D+00  0.00000000D+00  0.00000000D+00  0.64363172D+00
  0.33350218D+00  0.00000000D+00  0.00000000D+00  0.00000000D+00  0.57302486D-01
  0.63659475D-01  0.89429130D-01  0.29385384D-01  0.63659475D-01  0.89429130D-01
  0.29385384D-01 -0.63659475D-01 -0.89429130D-01 -0.29385384D-01 -0.63659475D-01
 -0.89429130D-01 -0.29385384D-01
......
END DATA
THE  HF ENERGY =    -39.976405845082 THE VIRIAL(-V/T)=   2.00033480
```

## 格式说明

- 第 1 行：`Title Card Required`
  - 没有意义，只是文件注释

- 第 2 行：`GAUSSIAN              5 MOL ORBITALS     27 PRIMITIVES        5 NUCLEI`
  - GAUSSIAN：表示函数类型
  - 5 MOL ORBITALS：分子轨道数，wfn中只记录占据轨道，虚轨道不记录
  - 27 PRIMITIVES：原始高斯函数的总数目
  - 5 NUCLEI：原子数

- 第 3-7 行：
```txt
  C    1    (CENTRE  1)   0.00000000  0.00000000  0.00000000  CHARGE =  6.0
  H    2    (CENTRE  2)   1.16740622  1.16740622  1.16740622  CHARGE =  1.0
  H    3    (CENTRE  3)  -1.16740622 -1.16740622  1.16740622  CHARGE =  1.0
  H    4    (CENTRE  4)  -1.16740622  1.16740622 -1.16740622  CHARGE =  1.0
  H    5    (CENTRE  5)   1.16740622 -1.16740622 -1.16740622  CHARGE =  1.0
```
  - 原子信息 `原子符号 原子序号 x y z 原子序号`，CENTRE=序号，CHARGE=电荷数，原子坐标单位为 **波尔**

- 第 8-9 行：
```txt
CENTRE ASSIGNMENTS    1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  2  2  2  3  3
CENTRE ASSIGNMENTS    3  4  4  4  5  5  5
```
  - 每项代表每个高斯函数所在的原子序号。由于一共有 27 个高斯函数，这里也就有 27 项。

- 第 10-11 行：
```txt
TYPE ASSIGNMENTS      1  1  1  1  1  2  2  3  3  4  4  1  2  3  4  1  1  1  1  1
TYPE ASSIGNMENTS      1  1  1  1  1  1  1
```
  - 每个高斯函数的类型。wfn文件中一般都是用笛卡尔型高斯函数，这里的数字与类型的对应关系是
    1. 1 => S、2 => X、3 => Y、4 => Z、5 => XX、6 => XX、7 => XX、8 => XY、9 => XZ、10 => YZ；
    2. 11 => XXX、12 => YYY、13 => ZZZ、14 => XXY、15 => XXZ、16 => YYZ、17 => XYY、18 => XZZ、19 => YZZ、20 => XYZ；


::: danger 注意⚠️
生成wfn文件时应注意应使用 `6d/10f` 型高斯函数而不要用球谐型。
:::

- 第 12-17 行：
```txt
EXPONENTS  0.1722560D+03 0.2591090D+02 0.5533350D+01 0.3664980D+01 0.7705450D+00
EXPONENTS  0.3664980D+01 0.7705450D+00 0.3664980D+01 0.7705450D+00 0.3664980D+01
EXPONENTS  0.7705450D+00 0.1958570D+00 0.1958570D+00 0.1958570D+00 0.1958570D+00
EXPONENTS  0.5447178D+01 0.8245472D+00 0.1831916D+00 0.5447178D+01 0.8245472D+00
EXPONENTS  0.1831916D+00 0.5447178D+01 0.8245472D+00 0.1831916D+00 0.5447178D+01
EXPONENTS  0.8245472D+00 0.1831916D+00
```
  - 每个高斯函数的指数，即 $N*x^{i_x}y^{i_y}z^{i_z}e^{-αr^2}$ 中的 $α$。
    
    其中：
      - $N$ 是归一化常数；
      - ${i_x}$,${i_y}$,${i_z}$ 是角量子数分量，决定了轨道的形状（s, p, d, f...）
      - $α$ 是指数，决定了高斯函数的“宽度”或“大小”；
      - $r^2 = x^2 + y^2 + z^2$

- 第 19-25 行：
```txt
......
MO    3     MO 0.0        OCC NO =    2.0000000  ORB. ENERGY =   -0.548298
  0.00000000D+00  0.00000000D+00  0.00000000D+00  0.00000000D+00  0.00000000D+00
  0.00000000D+00  0.00000000D+00  0.00000000D+00  0.00000000D+00  0.64363172D+00
  0.33350218D+00  0.00000000D+00  0.00000000D+00  0.00000000D+00  0.57302486D-01
  0.63659475D-01  0.89429130D-01  0.29385384D-01  0.63659475D-01  0.89429130D-01
  0.29385384D-01 -0.63659475D-01 -0.89429130D-01 -0.29385384D-01 -0.63659475D-01
 -0.89429130D-01 -0.29385384D-01
......
```
  - 这部分是分子轨道信息，这里表示第三条分子轨道的信息。
    - MO    3代表是第3条轨道，也就是它在高斯中的轨道序号。对于闭壳层，这个序号和此轨道在本文件中的序号一致。
    - MO 0.0没有任何意义，只是个标签。
    - NO =    2.0000000是占据数，这里就是代表有两个电子占据，若是非限制性波函数即为1。若是限制性开壳层计算，高斯会误把单占据轨道占据数写为2，需手动修改为1。
    - ORB. ENERGY =   -0.548298是轨道能，单位为Hartree。
    - 接下来就是分子轨道向这27个高斯函数的展开系数。

::: danger 注意⚠️
这里的轨道并非一定是分子轨道，如果用后HF方法，并且加了density=current表明用后HF密度，则输出的每个轨道就是自然轨道，其占据数一般不是整数，输出的轨道数目与可独立变分的基函数一致。因为后HF密度的自然轨道没有是否占据之分，只有占据多少之分，每条轨道都对电子密度有贡献，所以所有的自然轨道都会列出。如果是开壳层计算，还应当加上pop=NOAB，这样就会记录自然自旋轨道。

轨道记录顺序是能量由低往高。注意对于自旋轨道，wfn中先按这个次序记录完所有alpha轨道再记录beta轨道。由于第一个beta轨道的能量肯定比最后的alpha轨道的能量低，所以通过检验轨道能量与前一个轨道能量的关系就能判断beta轨道从哪里开始记录。如果是自然自旋轨道，则要判断它与前一个轨道的占据数关系。

wfn中轨道的轨道序号，记录的前后顺序是随意的。高斯函数的顺序也是随意的，只要在类型、所在中心、指数、轨道展开系数段落中的位置对应就行，不会影响结果。
:::

- 第 27 行：`END DATA`
其中END DATA代表标准wfn文件要求的全部信息的说明已结束，在此之后允许附加一些信息。

- 第 28 行及之后：
```txt
 THE  HF ENERGY =    -39.976405845082 THE VIRIAL(-V/T)=   2.00033480
```
  - 这些是附加信息，是随意的。
  
  一般量化程序输出的wfn都会按照这个格式输出能量和维里值。
  
  THE  HF ENERGY是体系HF或DFT总能量，如果是后HF方法，这里仍然是HF能量。有的程序还会附上其它一些信息。