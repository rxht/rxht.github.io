---
Date: 2025-08-27 18:09:44
LastEditTime: 2025-08-28 10:11:06
description: 系统梳理 MolStar 可直接读取的 FCH(FCHK) 文件格式：字段含义、Fortran 描述符、壳层类型、基函数顺序及密度矩阵存储方式，并附常见陷阱提示。
head:
  - - meta
    - name: keywords
      content: MolStar, fch, fchk, 高斯型轨道, 基组格式, 密度矩阵, Fortran 格式描述符
tags:
  - MolStar
  - fch
  - fchk
---

# FCH

```txt
Generated by Multiwfn
SP        UB3LYP                                              6-31G(d)
Number of atoms                            I                6
Charge                                     I                0
Multiplicity                               I                1
Number of electrons                        I               16
Number of alpha electrons                  I                8
Number of beta electrons                   I                8
Number of basis functions                  I               48
Number of independent functions            I               48
Atomic numbers                             I   N=           6
           6           1           1           6           1           1
Nuclear charges                            R   N=           6
  6.00000000E+00  1.00000000E+00  1.00000000E+00  6.00000000E+00  1.00000000E+00
  1.00000000E+00
Current cartesian coordinates              R   N=          18
  0.00000000E+00 -1.26440725E+00  0.00000000E+00  1.74190048E+00 -2.34125762E+00
  0.00000000E+00 -1.74190048E+00 -2.34125762E+00  0.00000000E+00  0.00000000E+00
  1.23032435E+00  0.00000000E+00 -1.74204134E+00  2.30727646E+00  0.00000000E+00
  1.74204134E+00  2.30727646E+00  0.00000000E+00
Translation vectors                        R   N=           0
Number of contracted shells                I               24
Number of primitive shells                 I               44
Highest angular momentum                   I                2
Largest degree of contraction              I                5
Shell types                                I   N=          24
           0           0           0           1           1          -2
           0           0           1           0           0           1
           0           0           0           1           1          -2
           0           0           1           0           0           1
Number of primitives per shell             I   N=          24
           5           1           1           3           1           1
           3           1           1           3           1           1
           5           1           1           3           1           1
           3           1           1           3           1           1
Shell to atom map                          I   N=          24
           1           1           1           1           1           1
           2           2           2           3           3           3
           4           4           4           4           4           4
           5           5           5           6           6           6
Primitive exponents                        R   N=          44
  1.23840169E+03  1.86290050E+02  4.22511763E+01  1.16765579E+01  3.59305065E+00
  4.02451474E-01  1.30901827E-01  9.46809706E+00  2.01035451E+00  5.47710047E-01
  1.52686138E-01  8.00000000E-01  1.30107010E+01  1.96225720E+00  4.44537960E-01
......
Contraction coefficients                   R   N=          44
  5.51736505E-03  4.10888286E-02  1.82253821E-01  4.68284594E-01  4.45758173E-01
  1.00000000E+00  1.00000000E+00  5.68883320E-02  3.12940593E-01  7.60650165E-01
  1.00000000E+00  1.00000000E+00  3.34854848E-02  2.34721871E-01  8.13770285E-01
......
Coordinates of each shell                  R   N=          72
  0.00000000E+00 -1.26440725E+00  0.00000000E+00  0.00000000E+00 -1.26440725E+00
  0.00000000E+00  0.00000000E+00 -1.26440725E+00  0.00000000E+00  0.00000000E+00
 -1.26440725E+00  0.00000000E+00  0.00000000E+00 -1.26440725E+00  0.00000000E+00
......
Virial Ratio                               R      2.005866370000000E+00
Total Energy                               R     -7.797799270000000E+01
Num ILSW                                   I              1
ILSW                                       I   N=         1
           1
Alpha Orbital Energies                     R   N=          48
 -1.12341061E+01 -1.12323805E+01 -1.02500678E+00 -7.81996430E-01 -6.42520300E-01
 -5.90941200E-01 -5.03355010E-01 -3.79987900E-01  1.68019500E-01  2.06074570E-01
  2.31568490E-01  2.40790830E-01  3.04487300E-01  4.87762490E-01  5.63280690E-01
......
Beta Orbital Energies                      R   N=          48
 -1.12341061E+01 -1.12323805E+01 -1.02500678E+00 -7.81996430E-01 -6.42520300E-01
 -5.90941200E-01 -5.03355010E-01 -3.79987900E-01  1.68019500E-01  2.06074570E-01
  2.31568490E-01  2.40790830E-01  3.04487300E-01  4.87762490E-01  5.63280690E-01
......
Alpha MO coefficients                      R   N=        2304
 -6.97078011E-01 -2.29766444E-02  1.12880246E-02  1.55083573E-11  1.25250914E-03
  1.52744925E-09 -7.76250642E-11 -6.15685404E-04 -1.12872822E-09  8.17808877E-04
 -8.26020130E-10 -1.38579601E-09  1.77038017E-04  7.48875882E-11  1.45829973E-03
......
Beta MO coefficients                       R   N=        2304
 -6.97078011E-01 -2.29766444E-02  1.12880246E-02  1.55083573E-11  1.25250914E-03
  1.52744925E-09 -7.76250642E-11 -6.15685404E-04 -1.12872822E-09  8.17808877E-04
 -8.26020130E-10 -1.38579601E-09  1.77038017E-04  7.48875882E-11  1.45829973E-03
......
Total SCF Density                          R   N=        1176
  2.09067418E+00 -1.73985653E-01  4.74521598E-01 -1.28903276E-01  1.51431374E-01
  5.44404867E-02 -7.41863014E-10  2.30133357E-09  1.12094079E-08  3.74756572E-01
 -1.14923138E-02  2.33310722E-02 -2.90530897E-02 -1.01814566E-08  4.13498859E-01
......
Spin SCF Density                           R   N=        1176
  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
......
```

## 格式说明

::: warning Fortran 的格式描述符说明

| 格式符   | 含义            | 说明                            |
| ----- | ------------- | ----------------------------- |
| `A40` | 读取 40 个字符的字符串 | 对应标签（如 `Primitive exponents`） |
| `3X`  | 跳过 3 个字符      | 通常是空格或分隔符                     |
| `A1`  | 读取 1 个字符的字符串  | 对应数据类型标识（`R`、`I`、`C`、`L`）     |
| `5X`  | 跳过 5 个字符      | 通常是空格或分隔符                     |
| `I12` | 读取 12 位整数     | 对应数据个数（如 `18`）                |

:::

- 第 1 行：`Generated by Multiwfn`
  - 标题，是任意的。
- 第 2 行：`SP        UB3LYP                                              6-31G(d)`
  - 任务类型、方法、基组，格式是 `A10,A30,A30`。看 **第11列** 是 **R**、**U** 还是 **RO** 就能判断波函数类型。

- 数据格式说明: 每一类数组型数据前面都有一行标签，读取格式都是`A40,3X,A1,5X,I12`。
  - R: 实数型数据
  - I: 整型数据
  - C：字符型数据
  - L：逻辑型数据

  如果出现 `N=` 则表示下一行开始就是这个属性的数据，例如: `Current cartesian coordinates              R   N=          18`，表示下面还有 18 个数据。同时注意每一行最多有 6 个数据。

```txt
Number of atoms                            I                6
Charge                                     I                0
Multiplicity                               I                1
Number of electrons                        I               16
Number of alpha electrons                  I                8
Number of beta electrons                   I                8
Number of basis functions                  I               48
Number of independent functions            I               48
Atomic numbers                             I   N=           6
Nuclear charges                            R   N=           6
Current cartesian coordinates              R   N=          18
Translation vectors                        R   N=           0
Number of contracted shells                I               24
Number of primitive shells                 I               44
Highest angular momentum                   I                2
Largest degree of contraction              I                5
Shell types                                I   N=          24
Number of primitives per shell             I   N=          24
Shell to atom map                          I   N=          24
Primitive exponents                        R   N=          44
Contraction coefficients                   R   N=          44
Coordinates of each shell                  R   N=          72
Virial Ratio                               R      2.005866370000000E+00
Total Energy                               R     -7.797799270000000E+01
Num ILSW                                   I              1
ILSW                                       I   N=         1
Alpha Orbital Energies                     R   N=          48
Beta Orbital Energies                      R   N=          48
Alpha MO coefficients                      R   N=        2304
Beta MO coefficients                       R   N=        2304
Total SCF Density                          R   N=        1176
Spin SCF Density                           R   N=        1176
```

- Shell types
  
  每个壳层的类型
    - 0=s, 1=p, -1=sp, 2=6d, -2=5d, 3=10f, -3=7f, 4=15g, -4=9g

- Number of primitives per shell
  
  每一壳层内的基函数的收缩度

::: danger 说明
每个壳层里笛卡尔型基函数的类型是按如下顺序排列
- S,X,Y,Z, XX,YY,ZZ,XY,XZ,YZ, XXX,YYY,ZZZ,XYY,XXY,XXZ,XZZ,YZZ,YYZ,XYZ

**g** 函数的顺序为
- ZZZZ,YZZZ,YYZZ,YYYZ,YYYY,XZZZ,XYZZ,XYYZ,XYYY,XXZZ,XXYZ,XXYY,XXXZ,XXXY,XXXX
:::

- Coordinates of each shell
  **Coordinates of each shell** 可由 **Shell to atom map（壳层所属原子）** 和 **Current cartesian coordinates（每个原子xyz坐标）** 推出。

- Total SCF Density（SCF密度矩阵）

  由于是对称的，只记录了下三角部分（含对角元），顺序是(1,1)(2,1)(2,2)(3,1)(3,2)(3,3)(4,1)...